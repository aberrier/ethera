{
	"initial": ["converse", "emotion-detection", "face-working", 3, 40],
	"groups": {
		"person-detection": [3, 9, 40],
		"emotion-detection": [16],
		"converse": [10, 43, 2, 1],
		"person-detection-know-out": [3, 9],
		"face-working": [41, 42]
	},
	"scenarios": [{
			"id": -2,
			"description": "Angry",
			"triggers": [{
				"service": "emotion",
				"name": "new",
				"parameters": {
					"emotion": "anger"
				}
			}],
			"actions": [{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "worried"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Voulez vous que j'appelle un conseiller pour venir vous aider ?"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [5, 9, 3]
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				}
			]
		},
		{
			"id": -1,
			"description": "Wait for converse -take appointment",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {
					"intent": "appointment"
				}
			}],
			"actions": [
        {
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "basic"
					}
				},
        {
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Vendredi 15 Juin à 17h.\nLundi 18 Juin à 14h.\nMercredi 20 Juin à 9h30."
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "input",
						"name": "storage",
						"variable": "Votre conseiller participe actuellement à un mite eupe. Voici ses disponibilité."
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["face-working", "converse", "person-detection", "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 0,
			"description": "Wait for audio - take appointment",
			"triggers": [{
				"service": "sound",
				"name": "new",
				"parameters": {}
			}],
			"actions": [{
					"name": "converse",
					"filepath": {
						"type": "service",
						"name": "sound",
						"variable": "filepath"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "computing2"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [-1, "converse"]
					}
				}
			]
		},
		{
			"id": 1,
			"description": "Wait for audio",
			"triggers": [{
				"service": "sound",
				"name": "new",
				"parameters": {}
			}],
			"actions": [{
					"name": "converse",
					"filepath": {
						"type": "service",
						"name": "sound",
						"variable": "filepath"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "computing2"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse"]
					}
				}
			]
		},
		{
			"id": 43,
			"description": "Wait for audio - recognize person",
			"triggers": [{
					"service": "sound",
					"name": "new",
					"parameters": {}
				},
				{
					"service": "face",
					"name": "know",
					"parameters": {
						"new": false
					}
				}
			],
			"actions": [{
					"name": "converse",
					"filepath": {
						"type": "service",
						"name": "sound",
						"variable": "filepath"
					},
					"id": {
						"type": "service",
						"name": "face",
						"variable": "id"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "computing2"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse"]
					}
				}
			]
		},
		{
			"id": 2,
			"description": "Wait for converse",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {}
			}],
			"actions": [{
					"name": "playSound",
					"filepath": {
						"type": "service",
						"name": "converse",
						"variable": "audiopath"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "basic2"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "service",
						"name": "converse",
						"variable": "reply"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["face-working", "converse", "person-detection", "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 10,
			"description": "Ask for operations",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {
					"intent": "ask-operations"
				}
			}],
			"actions": [{
					"name": "activateKeyboardInput",
					"activate": {
						"type": "input",
						"variable": false
					}
				},
        {
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "basic"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Voici vos dernières opérations :"
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "30 mai 2018 : VIREMENT SURICATS : +856€\n30 mai 2018 : CB MIAM-MIAM NOODL : -8,90€\n29 mai 2018 : CB Spotify : -14,99€\n11 mai 2018 : CB SUBWAY : -10,50€"
					},
					"variables": [{
							"firstname": {
								"type": "service",
								"name": "face",
								"variable": "firstname"
							}
						},
						{
							"lastname": {
								"type": "service",
								"name": "face",
								"variable": "lastname"
							}
						}
					]
				},
				{
					"name": "wait",
					"time": {
						"type": "input",
						"variable": 4000
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "input",
						"variable": "Que voulez vous faire maintenant ?"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "listening"
					}
				},
				{
					"name": "wait",
					"time": {
						"type": "input",
						"variable": 5000
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [-2, 0, "converse", "person-detection", "emotion-detection"]
					}
				}
			]

		},
		{
			"id": 3,
			"description": "Recognize a known person",
			"triggers": [{
				"service": "face",
				"name": "know",
				"parameters": {}
			}],
			"actions": [{
					"name": "activateKeyboardInput",
					"activate": {
						"type": "input",
						"variable": false
					}
				},
        {
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "basic"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Bonjour {@firstname} {@lastname}. Que puis-je faire pour vous ?"
					},
					"variables": [{
							"firstname": {
								"type": "service",
								"name": "face",
								"variable": "firstname"
							}
						},
						{
							"lastname": {
								"type": "service",
								"name": "face",
								"variable": "lastname"
							}
						}
					]
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [-2, 0, "converse", "person-detection", "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 5,
			"description": "Wait for audio when person is angry",
			"triggers": [{
				"service": "sound",
				"name": "new",
				"parameters": {}
			}],
			"actions": [{
					"name": "converse",
					"filepath": {
						"type": "service",
						"name": "sound",
						"variable": "filepath"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [6, 7, 8, 9]
					}
				}
			]
		},
		{
			"id": 6,
			"description": "Wait for converse : yes - angry person",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {
					"intent": "say-yes"
				}
			}],
			"actions": [{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "worried"
					}
				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "J'appelle un conseiller pour qu'il puisse vous aider."
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse", "person-detection", "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 7,
			"description": "Wait for converse : no - angry person",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {
					"intent": "say-no"
				}
			}],
			"actions": [{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Très bien. Je suis à votre service."
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "wait",
					"time": {
						"type": "input",
						"variable": 2
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse", "person-detection", "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 8,
			"description": "Wait for converse : don't understand - angry person",
			"triggers": [{
				"service": "converse",
				"name": "new",
				"parameters": {}
			}],
			"actions": [{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Je n'ai pas compris. Je vais appeler un conseiller pour venir vous aider."
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": [5, 9, 40, 3]
					}
				}
			]
		},
		{
			"id": 9,
			"description": "Nobody on front of camera (someone just leaved)",
			"triggers": [{
				"service": "face",
				"name": "nobody",
				"parameters": {}
			}],
			"actions": [{
					"name": "activateKeyboardInput",
					"activate": {
						"type": "input",
						"variable": false
					}

				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Au revoir."
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "sleeping"
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse", 3, 40, "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 40,
			"description": "Too many known people",
			"triggers": [{
				"service": "face",
				"name": "several",
				"parameters": {}
			}],
			"actions": [{
					"name": "activateKeyboardInput",
					"activate": {
						"type": "input",
						"variable": false
					}

				},
				{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "Il y'a trop de personnes devant la camera ! Je suis perdu !"
					}
				},
				{
					"name": "changeSuriface",
					"image": {
						"type": "input",
						"variable": "sad"
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse", 3, 9, "emotion-detection"]
					}
				}
			]
		},
		{
			"id": 41,
			"description": "Face is working",
			"triggers": [{
				"service": "face",
				"name": "working",
				"parameters": {
					"value": true
				}
			}],
			"actions": [{
				"name": "changeSuriface",
				"image": {
					"type": "input",
					"variable": "listening"
				}
			}]
		},
		{
			"id": 42,
			"description": "Face is not working",
			"triggers": [{
				"service": "face",
				"name": "working",
				"parameters": {
					"value": false
				}
			}],
			"actions": [{
				"name": "changeSuriface",
				"image": {
					"type": "input",
					"variable": "basic"
				}
			}]
		},
		{
			"id": 16,
			"description": "HAPPY - tell",
			"triggers": [{
					"service": "emotion",
					"name": "new",
					"parameters": {
						"emotion": "happiness"
					}
				},
				{
					"service": "face",
					"name": "know",
					"parameters": {}
				}
			],
			"actions": [{
					"name": "displayText",
					"text": {
						"type": "input",
						"variable": "{@firstname}, ça me fait plaisir de voir que tu es heureux aujourd'hui :)"
					},
					"variables": [{
						"firstname": {
							"type": "service",
							"name": "face",
							"variable": "firstname"
						}
					}]
				},
				{
					"name": "callScenarios",
					"id": {
						"type": "input",
						"variable": ["converse", "person-detection", "emotion-detection"]
					}
				},
				{
					"name": "speak",
					"text": {
						"type": "service",
						"name": "storage",
						"variable": "@text"
					}
				}
			]
		}
	]
}
