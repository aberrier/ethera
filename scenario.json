{
  "initial": ["converse","emotion-detection","special-persons","face-working",3,4,10],
  "groups" : {
    "person-detection" : [3,4,9,10],
    "emotion-detection" : [3000,3006],
    "special-persons" : [1001,1002,1003,1004],
    "converse" : [4000, 2005, 2004, 2003, 2002,2001,2000,0,2,1],
    "person-detection-know-out" : [3,9],
    "face-working" : [11,12]
  },
  "templates" :
  {
    "base" : {
      "description": "Base template",
      "before": [
        {
          "name": "changeSuriface",
          "image": {
            "type": "input",
            "variable": "basic2"
          }
        },
        {
          "name": "activateKeyboardInput",
          "activate": {
            "type": "input",
            "variable": false
          }
        }
      ]
    },
    "computing": {
      "description": "Computing template",
      "after" : [
        {
          "name": "changeSuriface",
          "image": {
            "type": "input",
            "variable": "computing2"
          }
        }
      ]
    },
    "take-picture": {
      "description": "Take picture template",
      "after": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "Très bien {@firstname} {@lastname}. Je vais prendre une photo maintenant ! Prépare toi !"
          },
          "variables": [
            {
              "firstname": {
                "type": "service",
                "name": "storage",
                "variable": "firstname"
              }
            },
            {
              "lastname": {
                "type": "service",
                "name": "storage",
                "variable": "lastname"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "3"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "2"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "1"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Cheese !"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "picture",
          "firstname": {
            "type": "service",
            "name": "storage",
            "variable": "firstname"
          },
          "lastname": {
            "type": "service",
            "name": "storage",
            "variable": "lastname"
          }

        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    "recognize-face": {
      "description": "Layout for recognizing someone while saying a specific message",
      "before": [
        {
          "name" : "memory",
          "field" : {
            "type": "input",
            "variable": "username"
          },
          "value" : {
            "type": "service",
            "name": "face",
            "variable": "name"
          },
          "id" : {
            "type": "service",
            "name": "face",
            "variable": "id"
          }
        },
        {
          "name": "changeSuriface",
          "image": {
            "type" : "input",
            "variable": "happy2"
          }
        }
      ],
      "after": [
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "wait",
          "time": {
            "type" : "input",
            "variable": 2000
          }
        },
        {
          "name": "notifications"
        },
        {
          "name": "displayText",
          "text":
          {
            "type": "service",
            "name": "storage",
            "variable": "@notifications"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    }
  },
  "scenarios": [
    {
      "id": 0,
      "description": "Wait for audio - recognize person",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        },
        {
          "service": "face",
          "name": "know",
          "parameters" : {
            "new": false
          }
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          },
          "id": {
            "type": "service",
            "name": "face",
            "variable": "id"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse"]
          }
        }
      ]
    },
    {
      "id": 1,
      "description": "Wait for audio",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse"]
          }
        }
      ]
    },
    {
      "id": 2,
      "description": "Wait for converse",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "converse",
            "variable": "reply"
          }
        },
        {
          "name": "playSound",
          "filepath": {
            "type": "service",
            "name": "converse",
            "variable": "audiopath"
          },
          "local": {
            "type": "service",
            "name": "converse",
            "variable": "local"
          },
          "message": {
            "type": "service",
            "name": "converse",
            "variable": "reply"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["face-working","converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 3,
      "description": "Recognize a known person",
      "templates" : ["base", "recognize-face"],
      "triggers": [
        {
          "service": "face",
          "name": "know",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "Bonjour {@firstname} {@lastname}. Voici vos notifications :"
          },
          "variables": [{
            "firstname": {
              "type": "service",
              "name": "face",
              "variable": "firstname"
            }
          },
            {
              "lastname": {
                "type": "service",
                "name": "face",
                "variable": "lastname"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        }
      ]
    },
    {
      "id": 4,
      "description": "Detect a unknown person",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "face",
          "name": "unknow",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Bonjour, je ne t'ai jamais vu ! Veux tu que je t'ajoute ?"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["special-persons",5,9,3]
          }
        }
      ]
    },
    {
      "id": 5,
      "description": "Wait for audio when an unknow person is recognized",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [6,7,8,9]
          }
        }
      ]
    },
    {
      "id": 6,
      "description": "Wait for converse : yes - unknow person",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-yes"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Très bien ! Quel est ton nom de famille ?"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [20]
          }
        }
      ]
    },
    {
      "id": 7,
      "description": "Wait for converse : no - unknow person",
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-no"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Très bien."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "wait",
          "time": {
            "type": "input",
            "variable": 2
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 8,
      "description": "Wait for converse : don't understand - unknow person",
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Répondez par OUI ou NON."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["special-persons",5,9,10,3]
          }
        }
      ]
    },
    {
      "id": 9,
      "description": "Nobody on front of camera (someone just leaved)",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "face",
          "name": "nobody",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Au revoir."
          }
        },
        {
          "name": "changeSuriface",
          "image": {
            "type" : "input",
            "variable": "sleeping"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons",3,4,10,"emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 10,
      "description": "Too many known people",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "face",
          "name": "several",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Il y a trop de personnes devant la caméra ! Je suis perdu !"
          }
        },
        {
          "name": "changeSuriface",
          "image": {
            "type" : "input",
            "variable": "sad"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons",3,4,9,"emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 11,
      "description": "Face is working",
      "triggers": [
        {
          "service": "face",
          "name": "working",
          "parameters": {
            "value" : true
          }
        }
      ],
      "actions": [
        {
          "name": "changeSuriface",
          "image": {
            "type" : "input",
            "variable": "listening"
          }
        }
      ]
    },
    {
      "id": 12,
      "description": "Face is not working",
      "triggers": [
        {
          "service": "face",
          "name": "working",
          "parameters": {
            "value" : false
          }
        }
      ],
      "actions": [
        {
          "name": "changeSuriface",
          "image": {
            "type" : "input",
            "variable": "basic"
          }
        }
      ]
    },
    {
      "id": 20,
      "description": "Listen for lastname",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "listen",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [22,21,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 21,
      "description": "Don't understand - unknow person lastname",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Essaie de parler plus fort !"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [20,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 22,
      "description": "Confirm name",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "@STT"
          }
        }
      ],
      "actions": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "J'ai compris {@name}. C'est bien ça ?"
          },
          "variables": [
            {
              "name": {
                "type": "service",
                "name": "converse",
                "variable": "reply"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "store",
          "list": {
            "lastname" : {
              "type" : "service",
              "name": "converse",
              "variable": "reply"
            }
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [23,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 23,
      "description": "Listen for confirmation lastname",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [24,25,26,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 24,
      "description": "Confirm name - yes",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-yes"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Parfait ! Quel est ton prénom ?"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [27,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 25,
      "description": "Confirm lastname - no",
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-no"
          }
        }
      ],
      "actions": [
        {
          "name": "activateKeyboardInput",
          "activate": {
            "type": "input",
            "variable": true
          },
          "text": {
            "type": "input",
            "variable":"Votre nom"
          }

        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Oh mince ! Redonne moi ton nom."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [20,34,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 26,
      "description": "Don't understand - unknow person lastname confirmation",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Répondez par OUI ou NON."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [23,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 27,
      "description": "Listen for firstname",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "listen",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [29,28,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 28,
      "description": "Don't understand - unknow person firstname",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Essaie de parler plus fort !"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [27,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 29,
      "description": "Confirm firstname",
      "templates" : ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "@STT"
          }
        }
      ],
      "actions": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "J'ai compris {@name}. C'est bien ça ?"
          },
          "variables": [
            {
              "name": {
                "type": "service",
                "name": "converse",
                "variable": "reply"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "store",
          "list": {
            "firstname" : {
              "type" : "service",
              "name": "converse",
              "variable": "reply"
            }
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [30,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 30,
      "description": "Listen for confirmation firstname",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [31,32,33,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 31,
      "description": "Confirm firstname - yes - TAKE PICTURE",
      "templates" : ["base", "take-picture"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-yes"
          }
        }
      ],
      "actions": []
    },
    {
      "id": 32,
      "description": "Confirm firstname - no",
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-no"
          }
        }
      ],
      "actions": [
        {
          "name": "activateKeyboardInput",
          "activate": {
            "type": "input",
            "variable": true
          },
          "text": {
            "type": "input",
            "variable": "Votre prénom"
          }

        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Oh mince ! Redonne moi ton prénom."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [27,35,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 33,
      "description": "Don't understand - unknow person firstname confirmation",
      "templates": ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Répondez par OUI ou NON."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [30,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 34,
      "description": "Wait for keyboard input - lastname",
      "triggers": [
        {
          "service": "keyboard",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions" : [
        {
          "name": "activateKeyboardInput",
          "activate": {
            "type": "input",
            "variable": false
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Parfait ! Quel est ton prénom ?"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "store",
          "list": {
            "lastname" : {
              "type" : "service",
              "name": "keyboard",
              "variable": "text"
            }
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [27,"person-detection-know-out"]
          }
        }
      ]
    },
    {
      "id": 35,
      "description": "Wait for keyboard input - firstname - TAKE PICTURE",
      "templates": ["base", "take-picture"],
      "triggers": [
        {
          "service": "keyboard",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions" : [
        {
          "name": "store",
          "list": {
            "firstname" : {
              "type" : "service",
              "name": "keyboard",
              "variable": "text"
            }
          }
        }
      ]
    },
    {
      "id": 1001,
      "description": "Recognize his creator",
      "templates": ["base", "recognize-face"],
      "triggers": [
        {
          "service": "face",
          "name": "know",
          "parameters": {
            "firstname" : "Alain",
            "lastname" : "Berrier"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Bonjour créateur. Voici vos notifications"
          }
        }
      ]
    },
    {
      "id": 1002,
      "description": "Recognize a founder of Suricats",
      "templates": ["base", "recognize-face"],
      "triggers": [
        {
          "service": "face",
          "name": "know",
          "parameters": {
            "firstname" : "\\b(Thierry|François|Bruno|Bernard)\\b",
            "lastname" : "\\b(Berdy|Giraudon|Levy|Chartier)\\b"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Oh un fantastique ! Voici vos notifications :"
          }
        }
      ]
    },
    {
      "id": 1003,
      "description": "Recognize Thomas Benguigui",
      "templates": ["base", "recognize-face"],
      "triggers": [
        {
          "service": "face",
          "name": "know",
          "parameters": {
            "firstname" : "Thomas",
            "lastname" : "Benguigui"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "TG THOMAS"
          }
        }
      ]
    },
    {
      "id": 1004,
      "description": "Wait for audio analysis",
      "templates" : ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "emotion",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["emotion"]
          }
        }
      ]
    },
    {
      "id": 2000,
      "description": "Ask for operations",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "ask-operations"
        }
      }],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Voici vos dernières opérations :"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "4 décembre 2018 : VIREMENT SURICATS : +856€\n4 décembre 2018 : CB MIAM-MIAM NOODL : -8,90€\n3 décembre 2018 : CB Spotify : -14,99€\n1 décembre 2018 : CB SUBWAY : -10,50€"
          },
          "variables": [{
            "firstname": {
              "type": "service",
              "name": "face",
              "variable": "firstname"
            }
          },
            {
              "lastname": {
                "type": "service",
                "name": "face",
                "variable": "lastname"
              }
            }
          ]
        },
        {
          "name": "wait",
          "time": {
            "type": "input",
            "variable": 4000
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "input",
            "variable": "Que voulez vous faire maintenant ?"
          }
        },
        {
          "name": "changeSuriface",
          "image": {
            "type": "input",
            "variable": "listening"
          }
        },
        {
          "name": "wait",
          "time": {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse", "person-detection", "emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 2001,
      "description": "Ask for temperature",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "ask-temperature"
        }
      }],
      "actions": [
        {
          "name": "giveSensorData",
          "type": {
            "type": "input",
            "variable": "temperature"
          },
          "output": {
            "type": "input",
            "variable": "last_temperature"
          }
        },
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "Il fait actuellement {@last_temperature}°C."
          },
          "variables": [{
            "last_temperature": {
              "type": "service",
              "name": "storage",
              "variable": "last_temperature"
            }
          }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse", "person-detection", "emotion-detection"]
          }
        }
      ]

    },
    {
      "id": 2002,
      "description": "Ask for humidity",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "ask-humidity"
        }
      }],
      "actions": [
        {
          "name": "giveSensorData",
          "type": {
            "type": "input",
            "variable": "humidity"
          },
          "output": {
            "type": "input",
            "variable": "last_humidity"
          }
        },
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "L'humidité est actuellement à {@last_humidity}%."
          },
          "variables": [{
            "last_humidity": {
              "type": "service",
              "name": "storage",
              "variable": "last_humidity"
            }
          }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse", "person-detection", "emotion-detection"]
          }
        }
      ]

    },
    {
      "id": 2003,
      "description": "Open fan",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "fan-on"
        }
      }],
      "actions": [
        {
          "name": "redis",
          "channel": {
            "type": "input",
            "variable": "slack"
          },
          "message": {
            "type": "input",
            "variable": "up"
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Et voilà ! C'est enclenché !"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse", "person-detection", "emotion-detection"]
          }
        }
      ]

    },
    {
      "id": 2004,
      "description": "Close fan",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "fan-off"
        }
      }],
      "actions": [
        {
          "name": "redis",
          "channel": {
            "type": "input",
            "variable": "slack"
          },
          "message": {
            "type": "input",
            "variable": "down"
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Et voilà ! C'est éteint !"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse", "person-detection", "emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 2005,
      "description": "Add picture",
      "templates": ["base"],
      "triggers": [{
        "service": "face",
        "name": "know",
        "parameters": {
          "new": false
        }
      },
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "ask-picture"
          }
        }],
      "actions": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "Très bien {@firstname} {@lastname}. Je vais prendre une photo maintenant ! Prépare toi !"
          },
          "variables": [
            {
              "firstname": {
                "type": "service",
                "name": "face",
                "variable": "firstname"
              }
            },
            {
              "lastname": {
                "type": "service",
                "name": "face",
                "variable": "lastname"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "3"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "2"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "1"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Cheese !"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 1000
          }
        },
        {
          "name": "picture_without",
          "id": {
            "type": "service",
            "name": "face",
            "variable": "id"
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "C'est fait ! :)"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 3000,
      "description": "SAD - Joke : ask",
      "templates": ["base"],
      "triggers": [
        {
          "service": "emotion",
          "name": "new",
          "parameters": {
            "emotion": "sadness"
          }
        },
        {
          "service": "face",
          "name": "know",
          "parameters": {
            "new": false
          }
        }
      ],
      "actions": [
        {
          "name": "changeSuriface",
          "image": {
            "type": "input",
            "variable": "sad"
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Oh tu es triste... Tu veux que je te raconte une blague ?"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["special-persons","person-detection",3001]
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        }
      ]
    },
    {
      "id": 3001,
      "description": "SAD - Joke : wait",
      "templates": ["base", "computing"],
      "triggers": [
        {
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "converse",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [3002,3004,3005]
          }
        }
      ]
    },
    {
      "id": 3002,
      "description": "SAD - Joke : confirm",
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-yes"
          }
        }
      ],
      "actions": [
        {
          "name": "converseText",
          "intent": {
            "type": "input",
            "variable": "Raconte moi une blague"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [3003]
          }
        }
      ]
    },
    {
      "id": 3003,
      "description": "SAD - Joke : tell",
      "templates": ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "converse",
            "variable": "reply"
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 3004,
      "description": "SAD - Joke : denied",
      "templates": ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "say-no"
          }
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Très bien."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "wait",
          "time": {
            "type": "input",
            "variable": 2
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        }
      ]
    },
    {
      "id": 3005,
      "description": "SAD - Joke : don't understand",
      "templates": ["base"],
      "triggers": [
        {
          "service": "converse",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Je n'ai pas compris. Répondez par OUI ou NON."
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["special-persons","person-detection",3001]
          }
        }
      ]
    },
    {
      "id": 3006,
      "description": "HAPPY - tell",
      "triggers": [
        {
          "service": "converse",
          "name": "new"
        }
      ],
      "actions": [
        {
          "name": "encodeText",
          "text": {
            "type": "input",
            "variable": "{@firstname}, ça me fait plaisir de voir que tu es heureux aujourd'hui :)"
          },
          "variables": [
            {
              "firstname": {
                "type": "service",
                "name": "face",
                "variable": "firstname"
              }
            }
          ]
        },
        {
          "name": "displayText",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@text"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": ["converse","special-persons","person-detection","emotion-detection"]
          }
        },
        {
          "name": "speak",
          "text": {
            "type": "service",
            "name": "storage",
            "variable": "@displayed_text"
          }
        }
      ]
    },
    {
      "id": 4000,
      "description": "Show image to person",
      "templates": ["base"],
      "triggers": [{
        "service": "converse",
        "name": "new",
        "parameters": {
          "intent": "show-picture"
        }
      }],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Prépare toi ! Je vais te montrer 3 images !"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "image",
          "image": {
            "type": "input",
            "variable": "chat"
          }
        },
         {
          "name": "store_results",
          "list": {
            "firstname" : {
              "type" : "service",
              "name": "converse",
              "variable": "store"
            }
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Que t'évoques cette image ?"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 5000
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [4002,"person-detection"]
          }
        }
      ]
    },
    {
      "id": 4001,
      "description": "Show another image to person",
      "templates": ["base"],
      "triggers": [{
          "service": "converse",
          "name": "new",
          "parameters": {
            "intent": "show-picture"
          }
        }],
      "actions": [
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Une autre image !"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 3000
          }
        },
        {
          "name": "image",
          "image": {
            "type": "input",
            "variable": "famine"
          }
        },
        {
          "name": "wait",
          "time" : {
            "type": "input",
            "variable": 3000
          }
        },
        {
          "name": "displayText",
          "text": {
            "type": "input",
            "variable": "Que t'évoques cette image ?"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [4002,"person-detection"]
          }
        }
      ]
    },
    {
      "id": 4002,
      "description": "Get avis image",
      "templates": ["base"],
      "triggers": [{
          "service": "sound",
          "name": "new",
          "parameters": {}
        }
      ],
      "actions": [
        {
          "name": "emotion",
          "filepath": {
            "type": "service",
            "name": "sound",
            "variable": "filepath"
          },
          "id": {
            "type": "service",
            "name": "face",
            "variable": "id"
          }
        },
        {
          "name": "callScenarios",
          "id": {
            "type": "input",
            "variable": [4001, "person-detection"]
          }
        }
      ]
    }
  ]
}

